
        <h3 id="使用说明" class="docs-header-link">
          <span header-link="使用说明"></span>
          使用说明
        </h3>
      <pre><code><div>wpm release <span class="token number">1.0</span><span class="token punctuation">.</span><span class="token number">1</span> # 明确版本号
wpm release patch # 语义化版本关键字<span class="token punctuation">:</span> `patch`、`minor`、`major`
wpm release       # 通过命令行提示选择版本</div></code></pre><p>运行以上命令，会执行以下步骤：</p>
<ol>
<li>切换到允许发布的分支，并列出当前版本和最后一次的 Tag</li>
<li>提示你选择一个新版本</li>
<li>创建一个 release 分支</li>
<li>修改包元数据（版本号）并生成更新日志</li>
<li>提交修改到 release 分支</li>
<li>推送代码到远程分支</li>
</ol>

        <h3 id="语义化升级版本-<code>bump</code>" class="docs-header-link">
          <span header-link="语义化升级版本-<code>bump</code>"></span>
          语义化升级版本 <code>bump</code>
        </h3>
      <pre class="language-sh"><code class="language-sh"><div>wpm release <span class="token punctuation">[</span>major | minor | patch | premajor | preminor | prepatch | prerelease<span class="token punctuation">]</span>
# uses the <span class="token keyword">next</span> semantic <span class="token function">version</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> value <span class="token operator">and</span> this skips `<span class="token keyword">Select</span> a new version <span class="token keyword">for</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>` prompt</div></code></pre>
<p>当指定了语义化升级版本后，<code>wpm release</code> 命令会忽略选择版本的步骤并且通过指定关键字<a target="_blank"href="https://github.com/npm/node-semver#functions">升级版本</a></p>

        <h3 id="选项" class="docs-header-link">
          <span header-link="选项"></span>
          选项
        </h3>
      <ul>
<li>  <code>--allow-branch</code></li>
<li>  <code>--dry-run</code></li>
<li>  <code>--skip</code></li>
<li>  <code>--release-branch-format</code></li>
<li>  <code>--issue-url-format</code></li>
<li>  <code>--bump-files</code></li>
<li>  <code>--infile</code></li>
<li>  <code>--preset</code></li>
<li>  <code>--commit-all</code></li>
<li>  <code>--hooks</code></li>
</ul>

        <h3 id="<code>--allow-branch-&lt;glob&gt;</code>" class="docs-header-link">
          <span header-link="<code>--allow-branch-&lt;glob&gt;</code>"></span>
          <code>--allow-branch &lt;glob&gt;</code>
        </h3>
      <p>允许执行 Release 的分支白名单，通过 glob 规则配置，默认为：<code>[&quot;master&quot;, &quot;develop&quot;]</code>，最简单也是推荐的做法是在<code>.wpmrc.js</code>配置文件中配置，但是通过 CLI 选项可以覆盖。</p>
<pre class="language-json"><code class="language-json"><div><span class="token punctuation">{</span>
  <span class="token property">"allowBranch"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"master"</span><span class="token punctuation">,</span> <span class="token string">"feature/*"</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span></div></code></pre>

        <h3 id="<code>--dry-run</code>" class="docs-header-link">
          <span header-link="<code>--dry-run</code>"></span>
          <code>--dry-run</code>
        </h3>
      <pre class="language-sh"><code class="language-sh"><div>wpm release <span class="token operator">-</span><span class="token operator">-</span>dry<span class="token operator">-</span>run
wpm publish <span class="token operator">-</span><span class="token operator">-</span>dry<span class="token operator">-</span>run</div></code></pre>
<p>通过 <code>--dry-run</code> 执行会让我们看到命令行的执行情况，但是不会修改文件和提交到 Git，主要供测试配置是否正确使用。 </p>

        <h3 id="<code>--skip</code>" class="docs-header-link">
          <span header-link="<code>--skip</code>"></span>
          <code>--skip</code>
        </h3>
      <p>跳过内置的生命周期步骤 (branch, bump, changelog, commit, push, tag)，也可以通过在 package.json 和 .rc 配置文件中设置。</p>
<p><code>release</code> 命令包含: branch, bump, changelog, commit, push
<code>publish</code> 包含: tag, push</p>
<p><code>--skip.branch --skip.bump</code></p>
<pre><code><div><span class="token operator">/</span><span class="token operator">/</span> package<span class="token punctuation">.</span>json
{
  <span class="token string">"wpm"</span><span class="token punctuation">:</span> {
    <span class="token string">"skip"</span><span class="token punctuation">:</span> {
      <span class="token string">"bump"</span><span class="token punctuation">:</span> <span class="token boolean">true</span>
    }
  }
}</div></code></pre><pre><code><div><span class="token operator">/</span><span class="token operator">/</span> <span class="token punctuation">.</span>wtpmrc<span class="token punctuation">.</span>js
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> {
   <span class="token string">"skip"</span><span class="token punctuation">:</span> {
      <span class="token string">"bump"</span><span class="token punctuation">:</span> <span class="token boolean">true</span>
    }
}</div></code></pre>
        <h3 id="<code>--release-branch-format</code>" class="docs-header-link">
          <span header-link="<code>--release-branch-format</code>"></span>
          <code>--release-branch-format</code>
        </h3>
      <p>创建 Release 分支的命名格式，默认：<code>release-v{{version}}</code></p>

        <h3 id="<code>--tag-prefix</code>" class="docs-header-link">
          <span header-link="<code>--tag-prefix</code>"></span>
          <code>--tag-prefix</code>
        </h3>
      <p>设置 Git Tag 的自定义前缀，默认为<code>v</code>.
如果你的项目之前是不带前缀(v)创建 Tag 的，你需要手动设置为空，否则更新日志会重新生成，将会丢失之前版本的更新日志。</p>
<p><code>--tag-prefix=</code></p>
<pre><code><div>{
    tagPrefix<span class="token punctuation">:</span> <span class="token string">""</span>
}</div></code></pre>
        <h3 id="<code>--issue-url-format</code>" class="docs-header-link">
          <span header-link="<code>--issue-url-format</code>"></span>
          <code>--issue-url-format</code>
        </h3>
      <p>Issue 格式化 URL，可以设置成 Github, Gitlab, Bitbucket等等，取决于你想要 #工作项编号 的 Issue URL，我们目前都是 #工作项 编号，那么我们肯定希望生成 PingCode 的工作项地址</p>
<p>默认： <code>https//at.pingcode.com/agile/items/{{id}}</code></p>

        <h3 id="<code>--bump-files</code>" class="docs-header-link">
          <span header-link="<code>--bump-files</code>"></span>
          <code>--bump-files</code>
        </h3>
      
        <h3 id="<code>--infile</code>" class="docs-header-link">
          <span header-link="<code>--infile</code>"></span>
          <code>--infile</code>
        </h3>
      <p>Read the CHANGELOG from this file, default is <code>CHANGELOG.md</code></p>

        <h3 id="<code>--preset</code>" class="docs-header-link">
          <span header-link="<code>--preset</code>"></span>
          <code>--preset</code>
        </h3>
      <p>List of preset see <a target="_blank"href="https://github.com/conventional-changelog/conventional-changelog">conventional-changelog</a>, by default, release use <a target="_blank"href="https://github.com/conventional-changelog/conventional-changelog/blob/master/packages/conventional-changelog-angular/README.md">angular preset</a></p>

        <h3 id="<code>--commit-all</code>" class="docs-header-link">
          <span header-link="<code>--commit-all</code>"></span>
          <code>--commit-all</code>
        </h3>
      <p>If you want to commit generated artifacts in the release commit, you can use the <code>--commit-all</code> or <code>-a</code> flag. You will need to stage the artifacts you want to commit, so your release command could look like this:</p>
<pre><code><div><span class="token string">"prerelease"</span><span class="token punctuation">:</span> <span class="token string">"npm run build-docs"</span><span class="token punctuation">,</span>
<span class="token string">"release"</span><span class="token punctuation">:</span> <span class="token string">"git add &lt;file(s) to commit> &amp;&amp; wpm release -commit-all"</span></div></code></pre>
        <h3 id="<code>--hooks</code>" class="docs-header-link">
          <span header-link="<code>--hooks</code>"></span>
          <code>--hooks</code>
        </h3>
      <p>wpm supports lifecycle hooks. These allow you to execute your own supplementary commands during the release or publish. The following hooks are available and execute in the order documented:</p>
<ul>
<li>  prerelease/postrelease: executed before/after anything happens. If the prerelease script returns a non-zero exit code, versioning will be aborted, but it has no other effect on the process.</li>
<li>  prebump/postbump: executed before and after the version is bumped. If the prebump script returns a version #, it will be used rather than the version calculated by standard-version.</li>
<li>  prechangelog/postchangelog: executes before and after the CHANGELOG is generated.</li>
<li>  precommit/postcommit: called before and after the commit step.</li>
<li>  pretag/posttag: called before and after the tagging step.</li>
</ul>
<p>Simply add the following to your package.json or .wtpmrc file to configure lifecycle hooks:</p>
<pre><code><div>{
  <span class="token string">"wpm"</span><span class="token punctuation">:</span> {
    <span class="token string">"hooks"</span><span class="token punctuation">:</span> {
      <span class="token string">"prebump"</span><span class="token punctuation">:</span> <span class="token string">"echo 9.9.9"</span>
    }
  }
}</div></code></pre><p>As an example to build artifacts before publish, publish artifacts to npm after created tag.</p>
<pre><code><div>{
  <span class="token string">"wpm"</span><span class="token punctuation">:</span> {
    <span class="token string">"hooks"</span><span class="token punctuation">:</span>
    {
      <span class="token string">"prepublish"</span><span class="token punctuation">:</span> <span class="token string">"npm run build"</span><span class="token punctuation">,</span>
      <span class="token string">"postpublish"</span><span class="token punctuation">:</span> <span class="token string">"cd built &amp;&amp; npm publish"</span>
   }
  }
}</div></code></pre>